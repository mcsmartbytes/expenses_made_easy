(()=>{var e={};e.id=837,e.ids=[837],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},9015:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d}),s(5954),s(6001),s(5866);var r=s(3191),a=s(8716),l=s(7922),i=s.n(l),n=s(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);s.d(t,o);let d=["",{children:["budgets",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,5954)),"/home/mcsmart/projects/active/expenses_made_easy/app/budgets/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,6001)),"/home/mcsmart/projects/active/expenses_made_easy/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/mcsmart/projects/active/expenses_made_easy/app/budgets/page.tsx"],u="/budgets/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/budgets/page",pathname:"/budgets",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},2207:(e,t,s)=>{Promise.resolve().then(s.bind(s,8545))},8545:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var r=s(326),a=s(7577),l=s(434),i=s(7553),n=s(2321);let o=["Meals & Entertainment","Travel","Office Supplies","Vehicle","Utilities","Marketing","Professional Services","Insurance","Rent","Software & Subscriptions","Equipment","Other"];function d(){let[e,t]=(0,a.useState)([]),[s,d]=(0,a.useState)([]),[c,u]=(0,a.useState)(!0),[x,m]=(0,a.useState)(!1),[g,p]=(0,a.useState)({category:"",amount:"",period:"monthly",profile:"business",alert_threshold:"80"}),[h,b]=(0,a.useState)(!1);async function y(){try{let{data:{user:e}}=await n.O.auth.getUser();if(!e){u(!1);return}let{data:s,error:r}=await n.O.from("budgets").select("*").eq("user_id",e.id).eq("is_active",!0).order("category");if(r)throw r;let a=await Promise.all((s||[]).map(async t=>{let s=await f(e.id,t);return{...t,spent:s}}));t(a)}catch(e){console.error("Error loading budgets:",e)}finally{u(!1)}}async function f(e,t){let s;let r=new Date;if("monthly"===t.period)s=new Date(r.getFullYear(),r.getMonth(),1);else if("quarterly"===t.period){let e=3*Math.floor(r.getMonth()/3);s=new Date(r.getFullYear(),e,1)}else s=new Date(r.getFullYear(),0,1);let a=n.O.from("expenses").select("amount").eq("user_id",e).gte("date",s.toISOString().split("T")[0]);if(a="business"===t.profile?a.eq("is_business",!0):a.eq("is_business",!1),"All Categories"!==t.category){let{data:e}=await n.O.from("categories").select("id").eq("name",t.category).single();e&&(a=a.eq("category_id",e.id))}let{data:l}=await a;return l?.reduce((e,t)=>e+Number(t.amount),0)||0}async function j(e){e.preventDefault(),b(!0);try{let e;let{data:{user:t}}=await n.O.auth.getUser();if(!t)throw Error("Not authenticated");let s=new Date;if("monthly"===g.period)e=new Date(s.getFullYear(),s.getMonth(),1);else if("quarterly"===g.period){let t=3*Math.floor(s.getMonth()/3);e=new Date(s.getFullYear(),t,1)}else e=new Date(s.getFullYear(),0,1);let{error:r}=await n.O.from("budgets").insert({user_id:t.id,category:g.category,amount:parseFloat(g.amount),period:g.period,profile:g.profile,alert_threshold:parseFloat(g.alert_threshold)/100,start_date:e.toISOString().split("T")[0],is_active:!0});if(r)throw r;m(!1),p({category:"",amount:"",period:"monthly",profile:"business",alert_threshold:"80"}),y()}catch(e){alert(e.message||"Failed to create budget")}finally{b(!1)}}async function v(e){if(!confirm("Are you sure you want to delete this budget?"))return;let{error:t}=await n.O.from("budgets").update({is_active:!1}).eq("id",e);t||y()}if(c)return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(i.Z,{}),r.jsx("div",{className:"flex items-center justify-center py-20",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Loading budgets..."})]})})]});let N=s.length>0?["All Categories",...s.map(e=>e.name)]:["All Categories",...o];return(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[r.jsx(i.Z,{}),r.jsx("header",{className:"bg-white shadow-sm",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Budget Tracking"}),r.jsx("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold",children:"+ Create Budget"})]})})}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[0===e.length?(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[r.jsx("div",{className:"text-6xl mb-4",children:"\uD83D\uDCCA"}),r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Budgets Yet"}),r.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first budget to start tracking your spending against your goals."}),r.jsx("button",{onClick:()=>m(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold",children:"Create Your First Budget"})]}):r.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>{let t=e.spent||0,s=Math.min(t/e.amount*100,100),a=Math.max(e.amount-t,0);return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,r.jsxs)("div",{children:[r.jsx("h3",{className:"font-semibold text-gray-900",children:e.category}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[r.jsx("span",{className:`px-2 py-0.5 text-xs rounded-full font-medium ${"business"===e.profile?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:"business"===e.profile?"Business":"Personal"}),r.jsx("span",{className:"text-xs text-gray-500 capitalize",children:e.period})]})]}),function(e,t,s){let a=e/t*100;return a>=100?r.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full font-medium",children:"Over Budget"}):a>=100*s?r.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full font-medium",children:"Near Limit"}):r.jsx("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"On Track"})}(t,e.amount,e.alert_threshold)]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[r.jsx("span",{className:"text-gray-600",children:"Spent"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",t.toFixed(2)," / $",e.amount.toFixed(2)]})]}),r.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:r.jsx("div",{className:`h-3 rounded-full transition-all ${function(e,t,s){let r=e/t*100;return r>=100?"bg-red-500":r>=100*s?"bg-yellow-500":"bg-green-500"}(t,e.amount,e.alert_threshold)}`,style:{width:`${s}%`}})}),(0,r.jsxs)("div",{className:"flex justify-between text-xs mt-1",children:[(0,r.jsxs)("span",{className:"text-gray-500",children:[s.toFixed(0),"% used"]}),(0,r.jsxs)("span",{className:"text-gray-500",children:["$",a.toFixed(2)," remaining"]})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsx("button",{onClick:()=>v(e.id),className:"text-sm text-red-600 hover:text-red-700",children:"Delete"})})]},e.id)})}),r.jsx("div",{className:"mt-8",children:r.jsx(l.default,{href:"/expense-dashboard",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"â† Back to Dashboard"})})]}),x&&r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Create New Budget"}),(0,r.jsxs)("form",{onSubmit:j,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,r.jsxs)("select",{value:g.category,onChange:e=>p({...g,category:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"",children:"Select a category"}),N.map(e=>r.jsx("option",{value:e,children:e},e))]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget Amount"}),(0,r.jsxs)("div",{className:"relative",children:[r.jsx("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:g.amount,onChange:e=>p({...g,amount:e.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Period"}),(0,r.jsxs)("select",{value:g.period,onChange:e=>p({...g,period:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"monthly",children:"Monthly"}),r.jsx("option",{value:"quarterly",children:"Quarterly"}),r.jsx("option",{value:"yearly",children:"Yearly"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,r.jsxs)("select",{value:g.profile,onChange:e=>p({...g,profile:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[r.jsx("option",{value:"business",children:"Business"}),r.jsx("option",{value:"personal",children:"Personal"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Alert Threshold (",g.alert_threshold,"%)"]}),r.jsx("input",{type:"range",min:"50",max:"100",value:g.alert_threshold,onChange:e=>p({...g,alert_threshold:e.target.value}),className:"w-full"}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["You'll see a warning when spending reaches ",g.alert_threshold,"% of your budget"]})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-4",children:[r.jsx("button",{type:"button",onClick:()=>m(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),r.jsx("button",{type:"submit",disabled:h,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:h?"Creating...":"Create Budget"})]})]})]})})]})}},5954:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>n});var r=s(8570);let a=(0,r.createProxy)(String.raw`/home/mcsmart/projects/active/expenses_made_easy/app/budgets/page.tsx`),{__esModule:l,$$typeof:i}=a;a.default;let n=(0,r.createProxy)(String.raw`/home/mcsmart/projects/active/expenses_made_easy/app/budgets/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,471,434,812,246],()=>s(9015));module.exports=r})();