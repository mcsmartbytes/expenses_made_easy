(()=>{var e={};e.id=326,e.ids=[326],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},3424:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>x,pages:()=>c,routeModule:()=>u,tree:()=>o}),t(3352),t(6001),t(5866);var r=t(3191),a=t(8716),l=t(7922),i=t.n(l),n=t(5231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);t.d(s,d);let o=["",{children:["expense-dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,3352)),"/home/mcsmart/projects/active/expenses_made_easy/app/expense-dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,6001)),"/home/mcsmart/projects/active/expenses_made_easy/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/mcsmart/projects/active/expenses_made_easy/app/expense-dashboard/page.tsx"],x="/expense-dashboard/page",m={require:t,loadChunk:()=>Promise.resolve()},u=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/expense-dashboard/page",pathname:"/expense-dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},6294:(e,s,t)=>{Promise.resolve().then(t.bind(t,8678))},8678:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>d});var r=t(326),a=t(7553),l=t(7577),i=t(434),n=t(2321);function d(){let[e,s]=(0,l.useState)({totalThisMonth:0,totalLastMonth:0,businessExpenses:0,personalExpenses:0,totalDeductible:0,fullyDeductible:0,partiallyDeductible:0}),[t,d]=(0,l.useState)([]),[o,c]=(0,l.useState)(!0);async function x(){try{console.log("\uD83D\uDCCA Loading dashboard...");let{data:{session:e}}=await n.O.auth.getSession();console.log("\uD83D\uDD11 Session check:",e?"✅ Found":"❌ Not found");let{data:{user:t}}=await n.O.auth.getUser();if(console.log("\uD83D\uDC64 User check:",t?`✅ ${t.email}`:"❌ Not found"),!t){console.log("⚠️ No user found, but continuing anyway (auth disabled for dev)"),c(!1);return}console.log("✅ User authenticated, loading data...");let r=new Date,a=new Date(r.getFullYear(),r.getMonth(),1),l=new Date(r.getFullYear(),r.getMonth()-1,1),i=new Date(r.getFullYear(),r.getMonth(),0),{data:o,error:x}=await n.O.from("expenses").select("amount, is_business, categories(deduction_percentage, is_tax_deductible)").eq("user_id",t.id).gte("date",a.toISOString().split("T")[0]);x&&(o=(await n.O.from("expenses").select("amount, is_business, categories(is_tax_deductible)").eq("user_id",t.id).gte("date",a.toISOString().split("T")[0])).data);let{data:m}=await n.O.from("expenses").select("amount").eq("user_id",t.id).gte("date",l.toISOString().split("T")[0]).lte("date",i.toISOString().split("T")[0]),{data:u}=await n.O.from("expenses").select("id, amount, description, date, vendor, is_business, categories(name, icon, color)").eq("user_id",t.id).order("date",{ascending:!1}).limit(5),h=o?.reduce((e,s)=>e+Number(s.amount),0)||0,p=m?.reduce((e,s)=>e+Number(s.amount),0)||0,g=o?.filter(e=>e.is_business).reduce((e,s)=>e+Number(s.amount),0)||0,b=o?.filter(e=>!e.is_business).reduce((e,s)=>e+Number(s.amount),0)||0,j=0,f=0,N=0;o?.forEach(e=>{let s=Number(e.amount),t="number"==typeof e.categories?.deduction_percentage?e.categories?.deduction_percentage:e.categories?.is_tax_deductible?100:0,r=s*t/100;j+=r,100===t?f+=r:t>0&&t<100&&(N+=r)}),s({totalThisMonth:h,totalLastMonth:p,businessExpenses:g,personalExpenses:b,totalDeductible:j,fullyDeductible:f,partiallyDeductible:N});let y=u?.map(e=>({...e,category:e.categories||null}))||[];d(y)}catch(e){console.error("Error loading dashboard:",e)}finally{c(!1)}}async function m(e){if(!confirm("Are you sure you want to delete this expense?"))return;let{error:s}=await n.O.from("expenses").delete().eq("id",e);s||x()}if(o)return r.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),r.jsx("p",{className:"text-gray-600",children:"Loading dashboard..."})]})});let u=e.totalLastMonth>0?(e.totalThisMonth-e.totalLastMonth)/e.totalLastMonth*100:0;return(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-gray-50 to-blue-50",children:[r.jsx(a.Z,{}),r.jsx("header",{className:"bg-white shadow-md border-b-2 border-blue-600",children:r.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Welcome back! Here's your expense overview"})]}),r.jsx("div",{className:"flex gap-3",children:(0,r.jsxs)(i.default,{href:"/expenses/new",className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold shadow-sm flex items-center gap-2",children:[r.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Expense"]})})]})})}),(0,r.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,r.jsxs)("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl shadow-lg p-6 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-blue-100",children:"This Month"}),r.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-2xl",children:"\uD83D\uDCB0"})})]}),(0,r.jsxs)("p",{className:"text-4xl font-bold mb-2",children:["$",e.totalThisMonth.toFixed(2)]}),0!==u&&(0,r.jsxs)("div",{className:`inline-flex items-center gap-1 text-sm font-medium px-2 py-1 rounded-full ${u>0?"bg-red-500/20 text-red-100":"bg-green-500/20 text-green-100"}`,children:[u>0?"↑":"↓"," ",Math.abs(u).toFixed(1),"% vs last month"]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-2 border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-600",children:"Last Month"}),r.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-2xl",children:"\uD83D\uDCC5"})})]}),(0,r.jsxs)("p",{className:"text-4xl font-bold text-gray-900",children:["$",e.totalLastMonth.toFixed(2)]}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Previous period"})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-green-600 to-green-700 rounded-xl shadow-lg p-6 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-green-100",children:"Business"}),r.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-2xl",children:"\uD83D\uDCBC"})})]}),(0,r.jsxs)("p",{className:"text-4xl font-bold mb-2",children:["$",e.businessExpenses.toFixed(2)]}),r.jsx("p",{className:"text-sm text-green-100",children:"Tax deductible expenses"})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 border-2 border-gray-200",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[r.jsx("h3",{className:"text-sm font-semibold text-gray-600",children:"Personal"}),r.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:r.jsx("span",{className:"text-2xl",children:"\uD83C\uDFE0"})})]}),(0,r.jsxs)("p",{className:"text-4xl font-bold text-gray-900",children:["$",e.personalExpenses.toFixed(2)]}),r.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Non-deductible"})]})]}),(0,r.jsxs)("div",{className:"bg-gradient-to-br from-purple-600 to-purple-800 rounded-xl shadow-lg p-6 mb-8 text-white",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-lg flex items-center justify-center",children:r.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-2xl font-bold",children:"Tax Deduction Summary"}),r.jsx("p",{className:"text-purple-100 text-sm",children:"IRS-compliant expense deductions for this month"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 border border-white/20",children:[r.jsx("p",{className:"text-purple-100 text-sm font-medium mb-1",children:"Total Deductible"}),(0,r.jsxs)("p",{className:"text-3xl font-bold",children:["$",e.totalDeductible.toFixed(2)]}),r.jsx("p",{className:"text-purple-100 text-xs mt-2",children:e.totalThisMonth>0?`${(e.totalDeductible/e.totalThisMonth*100).toFixed(0)}% of total expenses`:"No expenses yet"})]}),(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 border border-white/20",children:[r.jsx("p",{className:"text-purple-100 text-sm font-medium mb-1",children:"100% Deductible"}),(0,r.jsxs)("p",{className:"text-3xl font-bold",children:["$",e.fullyDeductible.toFixed(2)]}),r.jsx("div",{className:"mt-2 flex items-center gap-2",children:r.jsx("span",{className:"px-2 py-0.5 bg-green-500/30 text-green-100 text-xs rounded-full font-medium",children:"Fully Deductible"})})]}),(0,r.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-4 border border-white/20",children:[r.jsx("p",{className:"text-purple-100 text-sm font-medium mb-1",children:"Partial Deductions"}),(0,r.jsxs)("p",{className:"text-3xl font-bold",children:["$",e.partiallyDeductible.toFixed(2)]}),r.jsx("div",{className:"mt-2 flex items-center gap-2",children:r.jsx("span",{className:"px-2 py-0.5 bg-yellow-500/30 text-yellow-100 text-xs rounded-full font-medium",children:"50% & Other"})})]})]}),r.jsx("div",{className:"mt-4 bg-white/10 backdrop-blur-sm rounded-lg p-4 border border-white/20",children:(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[r.jsx("svg",{className:"w-5 h-5 text-purple-200 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,r.jsxs)("p",{className:"text-purple-100 text-sm",children:[r.jsx("strong",{children:"Tax Savings Estimate:"})," Based on a 24% tax bracket, your deductible expenses could save you approximately ",(0,r.jsxs)("strong",{className:"text-white",children:["$",(.24*e.totalDeductible).toFixed(2)]})," in taxes this month."]})]})})]}),(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border-2 border-gray-200",children:[(0,r.jsxs)("div",{className:"px-6 py-5 border-b-2 border-gray-200 flex justify-between items-center bg-gradient-to-r from-gray-50 to-white",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Recent Expenses"}),(0,r.jsxs)(i.default,{href:"/expenses",className:"text-sm text-blue-600 hover:text-blue-700 font-semibold flex items-center gap-1",children:["View All",r.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})]}),r.jsx("div",{className:"divide-y divide-gray-200",children:0===t.length?(0,r.jsxs)("div",{className:"p-8 text-center",children:[r.jsx("p",{className:"text-gray-500 mb-4",children:"No expenses yet"}),r.jsx(i.default,{href:"/expenses/new",className:"inline-block px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold",children:"Add Your First Expense"})]}):t.map(e=>r.jsx("div",{className:"px-6 py-4 hover:bg-gray-50",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[e.category&&r.jsx("span",{className:"text-2xl",children:e.category.icon}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("p",{className:"font-medium text-gray-900",children:e.description}),e.is_business&&r.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:"Business"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[r.jsx("span",{children:new Date(e.date).toLocaleDateString()}),e.vendor&&(0,r.jsxs)("span",{children:["• ",e.vendor]}),e.category&&(0,r.jsxs)("span",{children:["• ",e.category.name]})]})]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:["$",e.amount.toFixed(2)]}),r.jsx("button",{onClick:()=>m(e.id),className:"text-red-600 hover:text-red-700 text-sm",children:"Delete"})]})]})},e.id))})]})]})]})}},3352:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>l,default:()=>n});var r=t(8570);let a=(0,r.createProxy)(String.raw`/home/mcsmart/projects/active/expenses_made_easy/app/expense-dashboard/page.tsx`),{__esModule:l,$$typeof:i}=a;a.default;let n=(0,r.createProxy)(String.raw`/home/mcsmart/projects/active/expenses_made_easy/app/expense-dashboard/page.tsx#default`)}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[948,471,434,812,246],()=>t(3424));module.exports=r})();