(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{8977:function(e,t,s){Promise.resolve().then(s.bind(s,7711))},7711:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(7437),l=s(2265),r=s(7138),n=s(6079),i=s(2094);let o=["Meals & Entertainment","Travel","Office Supplies","Vehicle","Utilities","Marketing","Professional Services","Insurance","Rent","Software & Subscriptions","Equipment","Other"];function d(){let[e,t]=(0,l.useState)([]),[s,d]=(0,l.useState)([]),[c,u]=(0,l.useState)(!0),[m,x]=(0,l.useState)(!1),[h,g]=(0,l.useState)({category:"",amount:"",period:"monthly",profile:"business",alert_threshold:"80"}),[f,p]=(0,l.useState)(!1);async function b(){let{data:{user:e}}=await i.O.auth.getUser();if(!e)return;let{data:t}=await i.O.from("categories").select("id, name, icon").order("name");t&&d(t)}async function y(){try{let{data:{user:e}}=await i.O.auth.getUser();if(!e){u(!1);return}let{data:s,error:a}=await i.O.from("budgets").select("*").eq("user_id",e.id).eq("is_active",!0).order("category");if(a)throw a;let l=await Promise.all((s||[]).map(async t=>{let s=await j(e.id,t);return{...t,spent:s}}));t(l)}catch(e){console.error("Error loading budgets:",e)}finally{u(!1)}}async function j(e,t){let s;let a=new Date;if("monthly"===t.period)s=new Date(a.getFullYear(),a.getMonth(),1);else if("quarterly"===t.period){let e=3*Math.floor(a.getMonth()/3);s=new Date(a.getFullYear(),e,1)}else s=new Date(a.getFullYear(),0,1);let l=i.O.from("expenses").select("amount").eq("user_id",e).gte("date",s.toISOString().split("T")[0]);if(l="business"===t.profile?l.eq("is_business",!0):l.eq("is_business",!1),"All Categories"!==t.category){let{data:e}=await i.O.from("categories").select("id").eq("name",t.category).single();e&&(l=l.eq("category_id",e.id))}let{data:r}=await l;return(null==r?void 0:r.reduce((e,t)=>e+Number(t.amount),0))||0}async function N(e){e.preventDefault(),p(!0);try{let e;let{data:{user:t}}=await i.O.auth.getUser();if(!t)throw Error("Not authenticated");let s=new Date;if("monthly"===h.period)e=new Date(s.getFullYear(),s.getMonth(),1);else if("quarterly"===h.period){let t=3*Math.floor(s.getMonth()/3);e=new Date(s.getFullYear(),t,1)}else e=new Date(s.getFullYear(),0,1);let{error:a}=await i.O.from("budgets").insert({user_id:t.id,category:h.category,amount:parseFloat(h.amount),period:h.period,profile:h.profile,alert_threshold:parseFloat(h.alert_threshold)/100,start_date:e.toISOString().split("T")[0],is_active:!0});if(a)throw a;x(!1),g({category:"",amount:"",period:"monthly",profile:"business",alert_threshold:"80"}),y()}catch(e){alert(e.message||"Failed to create budget")}finally{p(!1)}}async function v(e){if(!confirm("Are you sure you want to delete this budget?"))return;let{error:t}=await i.O.from("budgets").update({is_active:!1}).eq("id",e);t||y()}if((0,l.useEffect)(()=>{y(),b()},[]),c)return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(n.Z,{}),(0,a.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading budgets..."})]})})]});let w=s.length>0?["All Categories",...s.map(e=>e.name)]:["All Categories",...o];return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(n.Z,{}),(0,a.jsx)("header",{className:"bg-white shadow-sm",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Budget Tracking"}),(0,a.jsx)("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold",children:"+ Create Budget"})]})})}),(0,a.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8 sm:px-6 lg:px-8",children:[0===e.length?(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-12 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCCA"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Budgets Yet"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Create your first budget to start tracking your spending against your goals."}),(0,a.jsx)("button",{onClick:()=>x(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-semibold",children:"Create Your First Budget"})]}):(0,a.jsx)("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:e.map(e=>{let t=e.spent||0,s=Math.min(t/e.amount*100,100),l=Math.max(e.amount-t,0);return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:e.category}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,a.jsx)("span",{className:"px-2 py-0.5 text-xs rounded-full font-medium ".concat("business"===e.profile?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:"business"===e.profile?"Business":"Personal"}),(0,a.jsx)("span",{className:"text-xs text-gray-500 capitalize",children:e.period})]})]}),function(e,t,s){let l=e/t*100;return l>=100?(0,a.jsx)("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full font-medium",children:"Over Budget"}):l>=100*s?(0,a.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full font-medium",children:"Near Limit"}):(0,a.jsx)("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full font-medium",children:"On Track"})}(t,e.amount,e.alert_threshold)]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-600",children:"Spent"}),(0,a.jsxs)("span",{className:"font-medium",children:["$",t.toFixed(2)," / $",e.amount.toFixed(2)]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,a.jsx)("div",{className:"h-3 rounded-full transition-all ".concat(function(e,t,s){let a=e/t*100;return a>=100?"bg-red-500":a>=100*s?"bg-yellow-500":"bg-green-500"}(t,e.amount,e.alert_threshold)),style:{width:"".concat(s,"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-xs mt-1",children:[(0,a.jsxs)("span",{className:"text-gray-500",children:[s.toFixed(0),"% used"]}),(0,a.jsxs)("span",{className:"text-gray-500",children:["$",l.toFixed(2)," remaining"]})]})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)("button",{onClick:()=>v(e.id),className:"text-sm text-red-600 hover:text-red-700",children:"Delete"})})]},e.id)})}),(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(r.default,{href:"/expense-dashboard",className:"text-blue-600 hover:text-blue-700 font-semibold",children:"← Back to Dashboard"})})]}),m&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Create New Budget"}),(0,a.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,a.jsxs)("select",{value:h.category,onChange:e=>g({...h,category:e.target.value}),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"",children:"Select a category"}),w.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget Amount"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),(0,a.jsx)("input",{type:"number",step:"0.01",min:"0",value:h.amount,onChange:e=>g({...h,amount:e.target.value}),required:!0,placeholder:"0.00",className:"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Period"}),(0,a.jsxs)("select",{value:h.period,onChange:e=>g({...h,period:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"monthly",children:"Monthly"}),(0,a.jsx)("option",{value:"quarterly",children:"Quarterly"}),(0,a.jsx)("option",{value:"yearly",children:"Yearly"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,a.jsxs)("select",{value:h.profile,onChange:e=>g({...h,profile:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,a.jsx)("option",{value:"business",children:"Business"}),(0,a.jsx)("option",{value:"personal",children:"Personal"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Alert Threshold (",h.alert_threshold,"%)"]}),(0,a.jsx)("input",{type:"range",min:"50",max:"100",value:h.alert_threshold,onChange:e=>g({...h,alert_threshold:e.target.value}),className:"w-full"}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["You'll see a warning when spending reaches ",h.alert_threshold,"% of your budget"]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>x(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:f,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition disabled:opacity-50",children:f?"Creating...":"Create Budget"})]})]})]})})]})}},6079:function(e,t,s){"use strict";s.d(t,{Z:function(){return o}});var a=s(7437),l=s(2265),r=s(7138),n=s(6463),i=s(2094);function o(){let e=(0,n.usePathname)(),t=(0,n.useRouter)(),[s,o]=(0,l.useState)(null),[d,c]=(0,l.useState)(!1),[u,m]=(0,l.useState)(!1);async function x(){let{data:{user:e}}=await i.O.auth.getUser();o(e)}async function h(){c(!0);try{await i.O.auth.signOut(),o(null),m(!1),t.push("/")}catch(e){console.error("Error signing out:",e)}finally{c(!1)}}(0,l.useEffect)(()=>{x()},[]),(0,l.useEffect)(()=>{m(!1)},[e]);let g=[{href:"/expense-dashboard",label:"Dashboard",icon:"\uD83D\uDCCA"},{href:"/expenses",label:"Expenses",icon:"\uD83D\uDCCB"},{href:"/budgets",label:"Budgets",icon:"\uD83D\uDCB0"},{href:"/receipts",label:"Receipts",icon:"\uD83E\uDDFE"},{href:"/mileage",label:"Mileage",icon:"\uD83D\uDE97"},{href:"/reports",label:"Reports",icon:"\uD83D\uDCC8"},{href:"/profile",label:"Profile",icon:"\uD83D\uDC64"}];return(0,a.jsx)("nav",{className:"bg-white shadow-sm border-b",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,a.jsxs)(r.default,{href:"/expense-dashboard",className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCB0"}),(0,a.jsx)("span",{className:"text-xl font-bold text-gray-900",children:"Expenses Made Easy"})]}),(0,a.jsxs)("div",{className:"hidden md:flex items-center gap-1",children:[g.map(t=>(0,a.jsxs)(r.default,{href:t.href,className:"px-4 py-2 rounded-lg text-sm font-medium transition ".concat(e===t.href?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("span",{className:"mr-1",children:t.icon}),t.label]},t.href)),s?(0,a.jsxs)("button",{onClick:h,disabled:d,className:"ml-2 px-4 py-2 rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-100 transition disabled:opacity-50",children:[(0,a.jsx)("span",{className:"mr-1",children:"\uD83D\uDEAA"}),d?"Logging out...":"Logout"]}):(0,a.jsxs)(r.default,{href:"/auth/login",className:"ml-2 px-4 py-2 rounded-lg text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 transition",children:[(0,a.jsx)("span",{className:"mr-1",children:"\uD83D\uDD10"}),"Login"]})]}),(0,a.jsx)("div",{className:"md:hidden",children:(0,a.jsx)("button",{onClick:()=>m(!u),className:"p-2 rounded-lg text-gray-700 hover:bg-gray-100","aria-label":"Toggle menu",children:u?"✕":"☰"})})]}),u&&(0,a.jsx)("div",{className:"md:hidden py-4 border-t",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[g.map(t=>(0,a.jsxs)(r.default,{href:t.href,className:"px-4 py-3 rounded-lg text-sm font-medium transition ".concat(e===t.href?"bg-blue-100 text-blue-700":"text-gray-700 hover:bg-gray-100"),children:[(0,a.jsx)("span",{className:"mr-2",children:t.icon}),t.label]},t.href)),(0,a.jsx)("div",{className:"border-t my-2 pt-2",children:s?(0,a.jsxs)("button",{onClick:h,disabled:d,className:"w-full px-4 py-3 rounded-lg text-sm font-medium text-left text-gray-700 hover:bg-gray-100 transition disabled:opacity-50",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDEAA"}),d?"Logging out...":"Logout"]}):(0,a.jsxs)(r.default,{href:"/auth/login",className:"block px-4 py-3 rounded-lg text-sm font-medium bg-blue-600 text-white hover:bg-blue-700 transition text-center",children:[(0,a.jsx)("span",{className:"mr-2",children:"\uD83D\uDD10"}),"Login"]})})]})})]})})}},6463:function(e,t,s){"use strict";var a=s(1169);s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},2094:function(e,t,s){"use strict";s.d(t,{O:function(){return a}});let a=(0,s(2835).eI)("https://vckynnyputrvwjhosryl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZja3lubnlwdXRydndqaG9zcnlsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4NDQ5OTgsImV4cCI6MjA3NTQyMDk5OH0.wpopXA3AtRSKAJdGqtcEtbBJPcpCGfeqm6VC27JkNEI",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"expenses-made-easy-auth"}})}},function(e){e.O(0,[138,835,971,23,744],function(){return e(e.s=8977)}),_N_E=e.O()}]);