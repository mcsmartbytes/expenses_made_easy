(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{2809:function(e,t,r){Promise.resolve().then(r.bind(r,7851))},7851:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return w}});var n,s=r(7437),a=r(2265),i=r(6463),l="https://js.stripe.com/v3",c=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,o=function(){for(var e=document.querySelectorAll('script[src^="'.concat(l,'"]')),t=0;t<e.length;t++){var r=e[t];if(c.test(r.src))return r}return null},u=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(l).concat(t);var n=document.head||document.body;if(!n)throw Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return n.appendChild(r),r},d=function(e,t){e&&e._registerWrapper&&e._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:t})},m=null,h=null,f=null,p=function(e,t,r){if(null===e)return null;var n=e.apply(void 0,t);return d(n,r),n},x=!1,b=function(){return n||(n=(null!==m?m:(m=new Promise(function(e,t){if("undefined"==typeof window||"undefined"==typeof document){e(null);return}if(window.Stripe,window.Stripe){e(window.Stripe);return}try{var r,n=o();n?n&&null!==f&&null!==h&&(n.removeEventListener("load",f),n.removeEventListener("error",h),null===(r=n.parentNode)||void 0===r||r.removeChild(n),n=u(null)):n=u(null),f=function(){window.Stripe?e(window.Stripe):t(Error("Stripe.js not available"))},h=function(){t(Error("Failed to load Stripe.js"))},n.addEventListener("load",f),n.addEventListener("error",h)}catch(e){t(e);return}})).catch(function(e){return m=null,Promise.reject(e)})).catch(function(e){return n=null,Promise.reject(e)}))};Promise.resolve().then(function(){return b()}).catch(function(e){x||console.warn(e)});var y=r(7138),g=r(2094);let v=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];x=!0;var n=Date.now();return b().then(function(e){return p(e,t,n)})}(r(357).env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY);function j(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),r=t.get("plan")||"premium",n=t.get("interval")||"month",[l,c]=(0,a.useState)(!1),[o,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(!0),[h,f]=(0,a.useState)("");async function p(){let{data:{user:e}}=await g.O.auth.getUser();u(e),m(!1)}(0,a.useEffect)(()=>{p()},[]);let x=async()=>{if(!o){e.push("/auth/login?redirect=/checkout?plan=".concat(r,"&interval=").concat(n));return}c(!0),f("");try{let e=await fetch("/api/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({plan:r,interval:n,userId:o.id,email:o.email})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to create checkout session");let s=await v;await s.redirectToCheckout({sessionId:t.sessionId})}catch(e){console.error(e),f(e.message||"Something went wrong"),c(!1)}},b={premium:{name:"Premium",monthlyPrice:"$9.99",yearlyPrice:"$79.99",features:["Unlimited expenses","Budget tracking","Receipt attachments","Export CSV/PDF"]},pro:{name:"Pro",monthlyPrice:"$19.99",yearlyPrice:"$159.99",features:["Everything in Premium","Advanced reports","Family sharing","API access"]}},j=b[r]||b.premium,w="year"===n?j.yearlyPrice:j.monthlyPrice;return d?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md w-full",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"Complete Purchase"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-6",children:["Start your 14-day free trial of ",j.name," plan"]}),(0,s.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,s.jsxs)("span",{className:"font-semibold text-lg",children:[j.name," Plan"]}),(0,s.jsxs)("span",{className:"text-2xl font-bold text-blue-600",children:[w,(0,s.jsxs)("span",{className:"text-sm text-gray-600",children:["/",n]})]})]}),(0,s.jsx)("ul",{className:"space-y-2",children:j.features.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-center text-sm text-gray-700",children:[(0,s.jsx)("svg",{className:"w-4 h-4 text-green-500 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),e]},t))})]}),!o&&(0,s.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6",children:(0,s.jsxs)("p",{className:"text-sm text-yellow-800",children:["Please ",(0,s.jsx)(y.default,{href:"/auth/login?redirect=/checkout?plan=".concat(r,"&interval=").concat(n),className:"font-semibold underline",children:"sign in"})," or"," ",(0,s.jsx)(y.default,{href:"/auth/signup",className:"font-semibold underline",children:"create an account"})," to continue."]})}),h&&(0,s.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-6",children:(0,s.jsx)("p",{className:"text-sm text-red-800",children:h})}),(0,s.jsx)("button",{onClick:x,disabled:l,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition",children:l?"Processing...":o?"Start Free Trial":"Sign In to Continue"}),(0,s.jsx)("p",{className:"text-xs text-center text-gray-500 mt-4",children:"14-day free trial. Cancel anytime. No charges during trial."}),(0,s.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200 flex justify-between",children:[(0,s.jsx)(y.default,{href:"/pricing",className:"text-sm text-gray-600 hover:text-gray-700",children:"← Back to Pricing"}),"month"===n&&(0,s.jsx)(y.default,{href:"/checkout?plan=".concat(r,"&interval=year"),className:"text-sm text-blue-600 hover:text-blue-700",children:"Save 33% with yearly →"})]})]})})}function w(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:"Loading..."}),children:(0,s.jsx)(j,{})})}},6463:function(e,t,r){"use strict";var n=r(1169);r.o(n,"usePathname")&&r.d(t,{usePathname:function(){return n.usePathname}}),r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}}),r.o(n,"useSearchParams")&&r.d(t,{useSearchParams:function(){return n.useSearchParams}})},2094:function(e,t,r){"use strict";r.d(t,{O:function(){return n}});let n=(0,r(2835).eI)("https://vckynnyputrvwjhosryl.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZja3lubnlwdXRydndqaG9zcnlsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk4NDQ5OTgsImV4cCI6MjA3NTQyMDk5OH0.wpopXA3AtRSKAJdGqtcEtbBJPcpCGfeqm6VC27JkNEI",{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"expenses-made-easy-auth"}})}},function(e){e.O(0,[138,835,971,23,744],function(){return e(e.s=2809)}),_N_E=e.O()}]);